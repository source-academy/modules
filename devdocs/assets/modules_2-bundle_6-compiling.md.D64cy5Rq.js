import{_ as i,c as a,o as e,a2 as n}from"./chunks/framework.BYVJ-AET.js";const c=JSON.parse('{"title":"Compiling a Bundle","description":"","frontmatter":{},"headers":[],"relativePath":"modules/2-bundle/6-compiling.md","filePath":"modules/2-bundle/6-compiling.md","lastUpdated":1762582830000}'),t={name:"modules/2-bundle/6-compiling.md"};function l(p,s,h,o,r,d){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="compiling-a-bundle" tabindex="-1">Compiling a Bundle <a class="header-anchor" href="#compiling-a-bundle" aria-label="Permalink to &quot;Compiling a Bundle&quot;">​</a></h1><p>This page contains information on compiling bundles, both for consumption by <code>js-slang</code> as well as other bundles.</p><div class="warning custom-block github-alert"><p class="custom-block-title">WARNING</p><p>The build tools automatically ignore files under a <code>__tests__</code> directory. Such files are considered test files and will not be included in the compiled output.</p></div><h2 id="for-js-slang" tabindex="-1">For <code>js-slang</code> <a class="header-anchor" href="#for-js-slang" aria-label="Permalink to &quot;For \`js-slang\`&quot;">​</a></h2><p>In its raw ESM format, the bundle is unsuitable for use with <code>js-slang</code>. It is thus necessary to compile your written Typescript into the format needed by <code>js-slang</code>.</p><p>Run the following command from within your bundle directory.</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yarn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Note that running this command will <strong>NOT</strong> perform typechecking. If you wish to perform typechecking, use the following command:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yarn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tsc</span></span></code></pre></div><p>This will run the TypeScript compiler before compiling your bundle. If there are any type errors, it will be displayed in the command line and your bundle will not be compiled.</p><p>The output for your bundle will be placed at <code>build/bundles/[your_bundle_name].js</code>.</p><h2 id="for-other-bundles" tabindex="-1">For Other Bundles <a class="header-anchor" href="#for-other-bundles" aria-label="Permalink to &quot;For Other Bundles&quot;">​</a></h2><p>A Source Bundle may use another Source Bundle as a dependency. As an example, the <code>plotly</code> bundle relies on the <code>curve</code> bundle:</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// plotly/src/curve_functions.ts</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { b_of, g_of, r_of, x_of, y_of, z_of } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@sourceacademy/bundle-curve&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Curve } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@sourceacademy/bundle-curve/curves_webgl&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Plotly, { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Data, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Layout } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;plotly.js-dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { CurvePlot } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./plotly&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>If you intend for your bundle to be consumed from other bundles, do the following:</p><h3 id="_1-ensure-that-your-tsconfig-json-is-properly-configured" tabindex="-1">1. Ensure that your <code>tsconfig.json</code> is properly configured <a class="header-anchor" href="#_1-ensure-that-your-tsconfig-json-is-properly-configured" aria-label="Permalink to &quot;1. Ensure that your \`tsconfig.json\` is properly configured&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;compilerOptions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;outDir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./dist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Make sure outDir is specified</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;noEmit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// noEmit should still be true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;declaration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // declaration needs to be true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_2-ensure-that-your-package-json-is-configured-correctly" tabindex="-1">2. Ensure that your <code>package.json</code> is configured correctly <a class="header-anchor" href="#_2-ensure-that-your-package-json-is-configured-correctly" aria-label="Permalink to &quot;2. Ensure that your \`package.json\` is configured correctly&quot;">​</a></h3><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@sourceacademy/bundle-curve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;module&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;exports&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./dist/index.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;./*&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./dist/*.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;scripts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;postinstall&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;yarn buildtools tsc&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Both the <code>exports</code> field and <code>postinstall</code> script are required. Refer to <a href="https://nodejs.org/api/packages.html#package-entry-points" target="_blank" rel="noreferrer">this page</a> for more information on how to configure your package exports.</p><details class="details custom-block"><summary>The <code>postinstall</code> script</summary><p>As per NPM <a href="https://docs.npmjs.com/cli/v8/using-npm/scripts#life-cycle-scripts" target="_blank" rel="noreferrer">docs</a>, when the package is being installed locally the <code>postinstall</code> script is executed. By providing this script, anyone else that adds your bundle as a dependency for their code won&#39;t have to manually build your bundle.</p></details><h3 id="_3-run-tsc" tabindex="-1">3. Run <code>tsc</code> <a class="header-anchor" href="#_3-run-tsc" aria-label="Permalink to &quot;3. Run \`tsc\`&quot;">​</a></h3><p>If necessary, run <code>yarn tsc</code> to produce Javascript and Typescript declaration files.</p>`,23)]))}const u=i(t,[["render",l]]);export{c as __pageData,u as default};
